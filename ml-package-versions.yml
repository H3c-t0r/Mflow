sklearn:
  package_info:
    pip_release: "scikit-learn"
    install_dev: |
      pip install git+https://github.com/scikit-learn/scikit-learn.git@master

  models:
    minimum: "0.20.4"
    maximum: "0.23.2"
    run: |
      pytest tests/sklearn/test_sklearn_model_export.py --large

  autologging:
    minimum: "0.20.4"
    maximum: "0.23.2"
    requirements: ["matplotlib"]
    run: |
      pytest tests/sklearn/test_sklearn_training_session.py --large
      pytest tests/sklearn/test_sklearn_autolog.py --large

pytorch:
  package_info:
    pip_release: "torch"
    install_dev: |
      pip install --pre torch -f https://download.pytorch.org/whl/nightly/cpu/torch_nightly.html

  models:
    minimum: "1.4.0"
    maximum: "1.7.0"
    requirements:
      # https://github.com/pytorch/vision#installation
      "== 1.4.0": ["torchvision==0.5.0", "scikit-learn"]
      "== 1.5.0": ["torchvision==0.6.0", "scikit-learn"]
      "== 1.5.1": ["torchvision==0.6.1", "scikit-learn"]
      "== 1.6.0": ["torchvision==0.7.0", "scikit-learn"]
      "> 1.6.0": ["torchvision", "scikit-learn"]
    run: |
      pytest tests/pytorch/test_pytorch_model_export.py --large

  autologging:
    minimum: "1.4.0"
    maximum: "1.7.0"
    requirements:
      "== 1.4.0": ["torchvision==0.5.0", "pytorch-lightning", "scikit-learn"]
      "== 1.5.0": ["torchvision==0.6.0", "pytorch-lightning", "scikit-learn"]
      "== 1.5.1": ["torchvision==0.6.1", "pytorch-lightning", "scikit-learn"]
      "== 1.6.0": ["torchvision==0.7.0", "pytorch-lightning", "scikit-learn"]
      "> 1.6.0": ["torchvision", "scikit-learn"]
    run: |
      pytest tests/pytorch/test_pytorch_model_export.py --large

tensorflow-1.x:
  package_info:
    pip_release: "tensorflow"

  models:
    minimum: "1.15.4"
    maximum: "1.15.4"
    requirements: ["h5py<3.0"]
    run: |
      pytest tests/tensorflow/test_tensorflow_model_export.py --large

  models:
    minimum: "1.15.4"
    maximum: "1.15.4"
    requirements: ["h5py<3.0"]
    run: |
      pytest tests/tensorflow_autolog/test_tensorflow_autolog.py --large

tensorflow-2.x:
  package_info:
    pip_release: "tensorflow"
    install_dev: |
      pip install tf-nightly

  models:
    minimum: "2.0.0"
    maximum: "2.3.1"
    run: |
      pytest tests/tensorflow/test_tensorflow2_model_export.py --large

  autologging:
    minimum: "2.0.0"
    maximum: "2.3.1"
    requirements:
      "< 2.2": ["h5py<3.0"]
    run: |
      pytest --verbose tests/tensorflow_autolog/test_tensorflow2_autolog.py --large

keras-tf1.x:
  package_info:
    pip_release: "keras"

  models:
    minimum: "2.2.5"
    maximum: "2.2.5"
    requirements: ["tensorflow==1.15.4", "h5py<3.0"]
    run: |
      pytest tests/keras/test_keras_model_export.py --large

  autologging:
    minimum: "2.2.5"
    maximum: "2.2.5"
    requirements: ["tensorflow==1.15.4", "h5py<3.0"]
    run: |
      pytest --verbose tests/keras_autolog/test_keras_autolog.py --large

keras-tf2.x:
  package_info:
    pip_release: "keras"
    install_dev: |
      # In keras >= 2.4.0, `keras` simply redirects to `tensorflow.keras`:
      # https://github.com/keras-team/keras#multi-backend-keras-and-tfkeras
      pip install tf-nightly 'keras>=2.4.0'

  models:
    minimum: "2.3.1"
    maximum: "2.4.3"
    requirements:
      "== 2.3.1":
        ["tensorflow==2.2.1", "scikit-learn", "pyspark==2.4.0", "pyarrow"]
      "> 2.3.1": ["tensorflow", "scikit-learn", "pyspark==2.4.0", "pyarrow"]
    run: |
      pytest tests/keras/test_keras_model_export.py --large

  autologging:
    minimum: "2.3.1"
    maximum: "2.4.3"
    requirements:
      "== 2.3.1": ["tensorflow==2.2.1"]
      "> 2.3.1": ["tensorflow"]
    run: |
      pytest --verbose tests/keras_autolog/test_keras_autolog.py --large

xgboost:
  package_info:
    pip_release: "xgboost"
    install_dev: |
      git clone --recursive https://github.com/dmlc/xgboost
      cd xgboost/python-package
      python setup.py install

  models:
    minimum: "0.90"
    maximum: "1.2.1"
    requirements: ["scikit-learn"]
    run: |
      pytest tests/xgboost/test_xgboost_model_export.py --large

  autologging:
    minimum: "0.90"
    maximum: "1.2.1"
    requirements: ["scikit-learn", "matplotlib"]
    run: |
      pytest tests/xgboost/test_xgboost_autolog.py --large

lightgbm:
  package_info:
    pip_release: "lightgbm"
    install_dev: |
      git clone --recursive https://github.com/microsoft/LightGBM.git
      cd LightGBM/python-package
      python setup.py install

  models:
    minimum: "2.3.1"
    maximum: "3.1.0"
    requirements: ["scikit-learn"]
    run: |
      pytest tests/lightgbm/test_lightgbm_model_export.py --large

  autologging:
    minimum: "2.3.1"
    maximum: "3.1.0"
    requirements: ["scikit-learn", "matplotlib"]
    run: |
      pytest tests/lightgbm/test_lightgbm_autolog.py --large
